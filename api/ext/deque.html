<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Event count" href="event_count.html" /><link rel="prev" title="Intrusive linked list" href="list.html" />

    <link rel="shortcut icon" href="../../_static/favicon.ico"/><!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>Work stealing queue - libfork documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=87344451" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">libfork  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/fork_light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/fork_light.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../core.html">Core API</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Core API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../eventually.html">Basic eventually</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../schedule.html">Schedulers</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../algorithm.html">Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts.html">Concepts and type traits</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../ext.html">Extension API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Extension API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="list.html">Intrusive linked list</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Work stealing queue</a></li>
<li class="toctree-l2"><a class="reference internal" href="event_count.html">Event count</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html">Xoshiro C++ implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="numa.html">Numa abstraction</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../impl.html">Internal docs</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/ConorWilliams/libfork/edit/main/docs/api/ext/deque.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="work-stealing-queue">
<h1>Work stealing queue<a class="headerlink" href="#work-stealing-queue" title="Permalink to this heading">#</a></h1>
<p>A stand-alone, production-quality implementation of the Chase-Lev lock-free single-producer multiple-consumer deque. </p>
<section id="concepts">
<h2>Concepts<a class="headerlink" href="#concepts" title="Permalink to this heading">#</a></h2>
<dl class="cpp concept">
<dt class="sig sig-object cpp" id="_CPPv4I0EN2lf3ext10atomicableE">
<span id="_CPPv3I0EN2lf3ext10atomicableE"></span><span id="_CPPv2I0EN2lf3ext10atomicableE"></span><span class="target" id="conceptlf_1_1ext_1_1atomicable"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">concept</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">atomicable</span></span></span><a class="headerlink" href="#_CPPv4I0EN2lf3ext10atomicableE" title="Permalink to this definition">#</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;libfork/core/ext/deque.hpp&gt;</em></div>
<p>Verify a type is suitable for use with <code class="docutils literal notranslate"><span class="pre">std::atomic</span></code></p>
<p>This requires a <code class="docutils literal notranslate"><span class="pre">TriviallyCopyable</span></code> type satisfying both <code class="docutils literal notranslate"><span class="pre">CopyConstructible</span></code> and <code class="docutils literal notranslate"><span class="pre">CopyAssignable</span></code>. </p>
</dd></dl>

<dl class="cpp concept">
<dt class="sig sig-object cpp" id="_CPPv4I0EN2lf3ext9lock_freeE">
<span id="_CPPv3I0EN2lf3ext9lock_freeE"></span><span id="_CPPv2I0EN2lf3ext9lock_freeE"></span><span class="target" id="conceptlf_1_1ext_1_1lock__free"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">concept</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lock_free</span></span></span><a class="headerlink" href="#_CPPv4I0EN2lf3ext9lock_freeE" title="Permalink to this definition">#</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;libfork/core/ext/deque.hpp&gt;</em></div>
<p>A concept that verifies a type is lock-free when used with <code class="docutils literal notranslate"><span class="pre">std::atomic</span></code>. </p>
</dd></dl>

<dl class="cpp concept">
<dt class="sig sig-object cpp" id="_CPPv4I0EN2lf3ext9dequeableE">
<span id="_CPPv3I0EN2lf3ext9dequeableE"></span><span id="_CPPv2I0EN2lf3ext9dequeableE"></span><span class="target" id="conceptlf_1_1ext_1_1dequeable"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">concept</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dequeable</span></span></span><a class="headerlink" href="#_CPPv4I0EN2lf3ext9dequeableE" title="Permalink to this definition">#</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;libfork/core/ext/deque.hpp&gt;</em></div>
<p>Test is a type is suitable for use with <code class="docutils literal notranslate"><span class="pre">lf::deque</span></code>. </p>
<p>This requires it to be <code class="docutils literal notranslate"><a class="reference internal" href="#conceptlf_1_1ext_1_1lock__free"><span class="std std-ref"><span class="pre">lf::ext::lock_free</span></span></a></code> and <code class="docutils literal notranslate"><span class="pre">std::default_initializable</span></code>. </p>
</dd></dl>

</section>
<section id="helpers">
<h2>Helpers<a class="headerlink" href="#helpers" title="Permalink to this heading">#</a></h2>
<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N2lf3ext3errE">
<span id="_CPPv3N2lf3ext3errE"></span><span id="_CPPv2N2lf3ext3errE"></span><span class="target" id="namespacelf_1_1ext_1ae59feaefcee8ed18b17cb16838b687b2"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">lf</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../../index.html#_CPPv4N2lf3extE" title="lf::ext"><span class="n"><span class="pre">ext</span></span></a><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">err</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><a class="headerlink" href="#_CPPv4N2lf3ext3errE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Error codes for <code class="docutils literal notranslate"><span class="pre">deque</span></code> ‘s <code class="docutils literal notranslate"><span class="pre">steal()</span></code> operation. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N2lf3ext3err4noneE">
<span id="_CPPv3N2lf3ext3err4noneE"></span><span id="_CPPv2N2lf3ext3err4noneE"></span><span class="target" id="namespacelf_1_1ext_1ae59feaefcee8ed18b17cb16838b687b2a334c4a4c42fdb79d7ebc3e73b517e6f8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">none</span></span></span><a class="headerlink" href="#_CPPv4N2lf3ext3err4noneE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">steal()</span></code> operation succeeded. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N2lf3ext3err4lostE">
<span id="_CPPv3N2lf3ext3err4lostE"></span><span id="_CPPv2N2lf3ext3err4lostE"></span><span class="target" id="namespacelf_1_1ext_1ae59feaefcee8ed18b17cb16838b687b2a1c9a44eb2e8eaf3da1eb551da310cce7"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lost</span></span></span><a class="headerlink" href="#_CPPv4N2lf3ext3err4lostE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Lost the <code class="docutils literal notranslate"><span class="pre">steal()</span></code> race hence, the <code class="docutils literal notranslate"><span class="pre">steal()</span></code> operation failed. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N2lf3ext3err5emptyE">
<span id="_CPPv3N2lf3ext3err5emptyE"></span><span id="_CPPv2N2lf3ext3err5emptyE"></span><span class="target" id="namespacelf_1_1ext_1ae59feaefcee8ed18b17cb16838b687b2aa2e4822a98337283e39f7b60acf85ec9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">empty</span></span></span><a class="headerlink" href="#_CPPv4N2lf3ext3err5emptyE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>The deque is empty and hence, the <code class="docutils literal notranslate"><span class="pre">steal()</span></code> operation failed. </p>
</dd></dl>

</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN2lf7steal_tE">
<span id="_CPPv3I0EN2lf7steal_tE"></span><span id="_CPPv2I0EN2lf7steal_tE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structlf_1_1ext_1_1steal__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">steal_t</span></span></span><a class="headerlink" href="#_CPPv4I0EN2lf7steal_tE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>The return type of a <code class="docutils literal notranslate"><span class="pre">lf::deque</span></code> <code class="docutils literal notranslate"><span class="pre">steal()</span></code> operation. </p>
<p>This type is suitable for structured bindings. We return a custom type instead of a <code class="docutils literal notranslate"><span class="pre">std::optional</span></code> to allow for more information to be returned as to why a steal may fail. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK2lf7steal_tcvbEv">
<span id="_CPPv3NK2lf7steal_tcvbEv"></span><span id="_CPPv2NK2lf7steal_tcvbEv"></span><span id="lf::steal_t::castto-b-operatorCCE"></span><span class="target" id="structlf_1_1ext_1_1steal__t_1a0825153beb780c19d3e77a09563c8376"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK2lf7steal_tcvbEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Check if the operation succeeded. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK2lf7steal_tmlEv">
<span id="_CPPv3NK2lf7steal_tmlEv"></span><span id="_CPPv2NK2lf7steal_tmlEv"></span><span id="lf::steal_t::mul-operatorCCE"></span><span class="target" id="structlf_1_1ext_1_1steal__t_1adab74cb02968a755fdc4a7b4150201cc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">*</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN2lf7steal_tE" title="lf::steal_t::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">&amp;</span></span><a class="headerlink" href="#_CPPv4NK2lf7steal_tmlEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the value like <code class="docutils literal notranslate"><span class="pre">std::optional</span></code>. </p>
<p>Requires <code class="docutils literal notranslate"><span class="pre">code</span> <span class="pre">==</span> <span class="pre">err::none</span></code> . </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2lf7steal_tmlEv">
<span id="_CPPv3N2lf7steal_tmlEv"></span><span id="_CPPv2N2lf7steal_tmlEv"></span><span id="lf::steal_t::mul-operatorCE"></span><span class="target" id="structlf_1_1ext_1_1steal__t_1a9781487a0a8769f6b4ba33f1db26022f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">*</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN2lf7steal_tE" title="lf::steal_t::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&amp;</span></span><a class="headerlink" href="#_CPPv4N2lf7steal_tmlEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the value like <code class="docutils literal notranslate"><span class="pre">std::optional</span></code>. </p>
<p>Requires <code class="docutils literal notranslate"><span class="pre">code</span> <span class="pre">==</span> <span class="pre">err::none</span></code> . </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK2lf7steal_tptEv">
<span id="_CPPv3NK2lf7steal_tptEv"></span><span id="_CPPv2NK2lf7steal_tptEv"></span><span id="lf::steal_t::pointer-operatorCCE"></span><span class="target" id="structlf_1_1ext_1_1steal__t_1ac26a28ef54331c12008d19909a02b9e5"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">-&gt;</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN2lf7steal_tE" title="lf::steal_t::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">*</span></span><a class="headerlink" href="#_CPPv4NK2lf7steal_tptEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the value <code class="docutils literal notranslate"><span class="pre">like</span> <span class="pre">std::optional</span></code>. </p>
<p>Requires <code class="docutils literal notranslate"><span class="pre">code</span> <span class="pre">==</span> <span class="pre">err::none</span></code> . </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2lf7steal_tptEv">
<span id="_CPPv3N2lf7steal_tptEv"></span><span id="_CPPv2N2lf7steal_tptEv"></span><span id="lf::steal_t::pointer-operatorCE"></span><span class="target" id="structlf_1_1ext_1_1steal__t_1a47b0087b7e78de5ee0657d48a0e3f335"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">-&gt;</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN2lf7steal_tE" title="lf::steal_t::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">*</span></span><a class="headerlink" href="#_CPPv4N2lf7steal_tptEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the value <code class="docutils literal notranslate"><span class="pre">like</span> <span class="pre">std::optional</span></code>. </p>
<p>Requires <code class="docutils literal notranslate"><span class="pre">code</span> <span class="pre">==</span> <span class="pre">err::none</span></code> . </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N2lf7steal_t4codeE">
<span id="_CPPv3N2lf7steal_t4codeE"></span><span id="_CPPv2N2lf7steal_t4codeE"></span><span id="lf::steal_t::code__err"></span><span class="target" id="structlf_1_1ext_1_1steal__t_1a63b2467f641bf45bf5e52ba659b6ebcc"></span><span class="n"><span class="pre">err</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">code</span></span></span><a class="headerlink" href="#_CPPv4N2lf7steal_t4codeE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>The error code of the <code class="docutils literal notranslate"><span class="pre">steal()</span></code> operation. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N2lf7steal_t3valE">
<span id="_CPPv3N2lf7steal_t3valE"></span><span id="_CPPv2N2lf7steal_t3valE"></span><span id="lf::steal_t::val__T"></span><span class="target" id="structlf_1_1ext_1_1steal__t_1a42629756ecbbc4dc6b95d9f046a5a761"></span><a class="reference internal" href="#_CPPv4I0EN2lf7steal_tE" title="lf::steal_t::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">val</span></span></span><a class="headerlink" href="#_CPPv4N2lf7steal_t3valE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>The value stolen from the deque, Only valid if <code class="docutils literal notranslate"><span class="pre">code</span> <span class="pre">==</span> <span class="pre">err::stolen</span></code>. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I0EN2lf14return_nulloptE">
<span id="_CPPv3I0EN2lf14return_nulloptE"></span><span id="_CPPv2I0EN2lf14return_nulloptE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structlf_1_1ext_1_1return__nullopt"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">return_nullopt</span></span></span><a class="headerlink" href="#_CPPv4I0EN2lf14return_nulloptE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>A functor that returns <code class="docutils literal notranslate"><span class="pre">std::nullopt</span></code>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2lf14return_nulloptclEv">
<span id="_CPPv3N2lf14return_nulloptclEv"></span><span id="_CPPv2N2lf14return_nulloptclEv"></span><span id="lf::return_nullopt::call-operatorCE"></span><span class="target" id="structlf_1_1ext_1_1return__nullopt_1adb49ca08440d9220b4da5b96ba9cb108"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">()</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN2lf14return_nulloptE" title="lf::return_nullopt::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N2lf14return_nulloptclEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">std::nullopt</span></code>. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="wsq">
<h2>WSQ<a class="headerlink" href="#wsq" title="Permalink to this heading">#</a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I_9dequeableEN2lf3ext5dequeE">
<span id="_CPPv3I_9dequeableEN2lf3ext5dequeE"></span><span id="_CPPv2I_9dequeableEN2lf3ext5dequeE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN2lf3ext9dequeableE" title="lf::ext::dequeable"><span class="n"><span class="pre">dequeable</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classlf_1_1ext_1_1deque"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">deque</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">private</span></span><span class="w"> </span><span class="n"><span class="pre">lf</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../../index.html#_CPPv4N2lf4implE" title="lf::impl"><span class="n"><span class="pre">impl</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">immovable</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_9dequeableEN2lf3ext5dequeE" title="lf::ext::deque"><span class="n"><span class="pre">deque</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_9dequeableEN2lf3ext5dequeE" title="lf::ext::deque::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I_9dequeableEN2lf3ext5dequeE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>An unbounded lock-free single-producer multiple-consumer work-stealing deque. </p>
<p><p>Implements the “Chase-Lev” deque described in the papers, <a class="reference external" href="https://doi.org/10.1145/1073970.1073974">“Dynamic Circular Work-Stealing deque”</a> and <a class="reference external" href="https://doi.org/10.1145/2442516.2442524">“Correct and Efficient Work-Stealing for Weak
Memory Models”</a>.</p>
<p>Only the deque owner can perform <code class="docutils literal notranslate"><span class="pre">pop()</span></code> and <code class="docutils literal notranslate"><span class="pre">push()</span></code> operations where the deque behaves
like a LIFO stack. Others can (only) <code class="docutils literal notranslate"><span class="pre">steal()</span></code> data from the deque, they see a FIFO deque.
All threads must have finished using the deque before it is destructed.</p>
<p>Example:</p>
<div class="code highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;atomic&gt;</span><span class="c1">   // for atomic</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;optional&gt;</span><span class="c1"> // for optional</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;thread&gt;</span><span class="c1">   // for thread</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span><span class="c1">   // for vector</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;libfork/core.hpp&quot;</span><span class="c1"> // for deque, err, steal_t, return_nullopt</span>

<span class="k">namespace</span><span class="w"> </span><span class="p">{</span>

<span class="k">auto</span><span class="w"> </span><span class="n">example</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Work-stealing deque of ints</span>
<span class="w">  </span><span class="n">lf</span><span class="o">::</span><span class="n">deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">deque</span><span class="p">;</span>

<span class="w">  </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num_items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10000</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// One thread can push and pop items from one end (like a stack)</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="w"> </span><span class="nf">owner</span><span class="p">([</span><span class="o">&amp;</span><span class="p">]()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_items</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">deque</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">optional</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deque</span><span class="p">.</span><span class="n">pop</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Do something with items...</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="c1">// While multiple (any) threads can steal items from the other end</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="w"> </span><span class="nf">thief</span><span class="p">([</span><span class="o">&amp;</span><span class="p">]()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">deque</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deque</span><span class="p">.</span><span class="n">steal</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Do something with item...</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">owner</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>
<span class="w">  </span><span class="n">thief</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">}</span><span class="w"> </span><span class="c1">// namespace</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>T</strong> – The type of the elements in the deque. </p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N2lf3ext5deque10value_typeE">
<span id="_CPPv3N2lf3ext5deque10value_typeE"></span><span id="_CPPv2N2lf3ext5deque10value_typeE"></span><span class="target" id="classlf_1_1ext_1_1deque_1a4a60073491a389e5280efd99209eccb2"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_9dequeableEN2lf3ext5dequeE" title="lf::ext::deque::T"><span class="n"><span class="pre">T</span></span></a><a class="headerlink" href="#_CPPv4N2lf3ext5deque10value_typeE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>The type of the elements in the deque. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2lf3ext5deque5dequeEv">
<span id="_CPPv3N2lf3ext5deque5dequeEv"></span><span id="_CPPv2N2lf3ext5deque5dequeEv"></span><span id="lf::ext::deque::dequeCE"></span><span class="target" id="classlf_1_1ext_1_1deque_1ad1ec9de308ddaf02ea27b731340324db"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">deque</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2lf3ext5deque5dequeEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Construct a new empty deque object. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2lf3ext5deque5dequeENSt9ptrdiff_tE">
<span id="_CPPv3N2lf3ext5deque5dequeENSt9ptrdiff_tE"></span><span id="_CPPv2N2lf3ext5deque5dequeENSt9ptrdiff_tE"></span><span id="lf::ext::deque::deque__std::ptrdiff_tCE"></span><span class="target" id="classlf_1_1ext_1_1deque_1ab25368a0efa2ad4885c38ba278be6be8"></span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">deque</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ptrdiff_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cap</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2lf3ext5deque5dequeENSt9ptrdiff_tE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Construct a new empty deque object. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cap</strong> – The capacity of the deque (must be a power of 2). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2lf3ext5dequeD0Ev">
<span id="_CPPv3N2lf3ext5dequeD0Ev"></span><span id="_CPPv2N2lf3ext5dequeD0Ev"></span><span id="lf::ext::deque::~dequeCE"></span><span class="target" id="classlf_1_1ext_1_1deque_1ad9973016a8edfaa18d8486a4f7c756cb"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~deque</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N2lf3ext5dequeD0Ev" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Destroy the deque object. </p>
<p>All threads must have finished using the deque before it is destructed. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK2lf3ext5deque8capacityEv">
<span id="_CPPv3NK2lf3ext5deque8capacityEv"></span><span id="_CPPv2NK2lf3ext5deque8capacityEv"></span><span id="lf::ext::deque::capacityCCE"></span><span class="target" id="classlf_1_1ext_1_1deque_1a032dd34bd0480d43ad92deba7dd03d34"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">capacity</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">ptrdiff_t</span></span><a class="headerlink" href="#_CPPv4NK2lf3ext5deque8capacityEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the capacity of the deque. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK2lf3ext5deque5emptyEv">
<span id="_CPPv3NK2lf3ext5deque5emptyEv"></span><span id="_CPPv2NK2lf3ext5deque5emptyEv"></span><span id="lf::ext::deque::emptyCCE"></span><span class="target" id="classlf_1_1ext_1_1deque_1a7c39895173b5122eca9e4efae5b2d5e0"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">empty</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><a class="headerlink" href="#_CPPv4NK2lf3ext5deque5emptyEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Check if the deque is empty. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_NSt9invocableEEN2lf3ext5deque3popENSt15invoke_result_tI1FEERR1F">
<span id="_CPPv3I_NSt9invocableEEN2lf3ext5deque3popERR1F"></span><span id="_CPPv2I_NSt9invocableEEN2lf3ext5deque3popERR1F"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">invocable</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">F</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN2lf14return_nulloptE" title="lf::return_nullopt"><span class="n"><span class="pre">return_nullopt</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_9dequeableEN2lf3ext5dequeE" title="lf::ext::deque::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classlf_1_1ext_1_1deque_1ae4373debb06d5af2e03c7d94334c1ba8"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pop</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I_NSt9invocableEEN2lf3ext5deque3popENSt15invoke_result_tI1FEERR1F" title="lf::ext::deque::pop::F"><span class="n"><span class="pre">F</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">when_empty</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="p"><span class="pre">}</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_nothrow_invocable_v</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt9invocableEEN2lf3ext5deque3popENSt15invoke_result_tI1FEERR1F" title="lf::ext::deque::pop::F"><span class="n"><span class="pre">F</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">invoke_result_t</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt9invocableEEN2lf3ext5deque3popENSt15invoke_result_tI1FEERR1F" title="lf::ext::deque::pop::F"><span class="n"><span class="pre">F</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I_NSt9invocableEEN2lf3ext5deque3popENSt15invoke_result_tI1FEERR1F" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Pop an item from the deque. </p>
<p>Only the owner thread can pop out an item from the deque. If the buffer is empty calls <code class="docutils literal notranslate"><span class="pre">when_empty</span></code> and returns the result. By default, <code class="docutils literal notranslate"><span class="pre">when_empty</span></code> is a no-op that returns a null <code class="docutils literal notranslate"><span class="pre">std::optional&lt;T&gt;</span></code>. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2lf3ext5deque4pushERK1T">
<span id="_CPPv3N2lf3ext5deque4pushERK1T"></span><span id="_CPPv2N2lf3ext5deque4pushERK1T"></span><span id="lf::ext::deque::push__TCRCE"></span><span class="target" id="classlf_1_1ext_1_1deque_1a21b59ecb51784baa2f56a6fa268b17bd"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">push</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I_9dequeableEN2lf3ext5dequeE" title="lf::ext::deque::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">val</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2lf3ext5deque4pushERK1T" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Push an item into the deque. </p>
<p>Only the owner thread can insert an item into the deque. This operation can trigger the deque to resize if more space is required. This may throw if an allocation is required and then fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> – Value to add to the deque. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK2lf3ext5deque4sizeEv">
<span id="_CPPv3NK2lf3ext5deque4sizeEv"></span><span id="_CPPv2NK2lf3ext5deque4sizeEv"></span><span id="lf::ext::deque::sizeCCE"></span><span class="target" id="classlf_1_1ext_1_1deque_1a6e1e7f682b3c8b60013c8f59933667f3"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><a class="headerlink" href="#_CPPv4NK2lf3ext5deque4sizeEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the number of elements in the deque. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK2lf3ext5deque5ssizeEv">
<span id="_CPPv3NK2lf3ext5deque5ssizeEv"></span><span id="_CPPv2NK2lf3ext5deque5ssizeEv"></span><span id="lf::ext::deque::ssizeCCE"></span><span class="target" id="classlf_1_1ext_1_1deque_1a897070f6dd6aa3daedcdd11909a284c6"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ssize</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">ptrdiff_t</span></span><a class="headerlink" href="#_CPPv4NK2lf3ext5deque5ssizeEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the number of elements in the deque as a signed integer. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2lf3ext5deque5stealEv">
<span id="_CPPv3N2lf3ext5deque5stealEv"></span><span id="_CPPv2N2lf3ext5deque5stealEv"></span><span id="lf::ext::deque::stealCE"></span><span class="target" id="classlf_1_1ext_1_1deque_1ab48b338b7d7e023b7ec4dcbe6dfe765d"></span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">steal</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN2lf7steal_tE" title="lf::steal_t"><span class="n"><span class="pre">steal_t</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_9dequeableEN2lf3ext5dequeE" title="lf::ext::deque::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N2lf3ext5deque5stealEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Steal an item from the deque. </p>
<p>Any threads can try to steal an item from the deque. This operation can fail if the deque is empty or if another thread simultaneously stole an item from the deque. </p>
</dd></dl>

</div>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="event_count.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Event count</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="list.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Intrusive linked list</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, ConorWilliams
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/ConorWilliams/libfork" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Work stealing queue</a><ul>
<li><a class="reference internal" href="#concepts">Concepts</a></li>
<li><a class="reference internal" href="#helpers">Helpers</a></li>
<li><a class="reference internal" href="#wsq">WSQ</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=ccbe24c1"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>